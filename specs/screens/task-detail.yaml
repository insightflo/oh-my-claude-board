version: "2.0"

screen:
  name: 태스크 상세 패널
  route: S-03
  layout: detail-fixed
  auth: false

data_requirements:
  - resource: tasks
    needs: [task_id, task_name, task_status, task_agent]

  - resource: hook_events
    needs: [timestamp, event_type, agent_id, tool_name, error_message]

  - resource: error_analysis
    needs: [analysis, category, retryable, suggestion]
    auth_required: false

components:
  - id: task_header
    type: detail
    position: main
    function: Task ID + 이름 + 상태 심볼 표시
    data_source:
      resource: tasks
    events: []

  - id: task_metadata
    type: detail
    position: main
    function: 에이전트명, 시작 시간, 경과 시간, 진행률 표시
    data_source:
      resource: tasks
    events: []

  - id: task_logs
    type: list
    position: main
    function: 최근 실행 로그 (타임스탬프 + 레벨 + 메시지)
    data_source:
      resource: hook_events
    events:
      - on: scroll
        do: 로그 스크롤

  - id: error_section
    type: detail
    position: main
    function: 에러 메시지 + AI 분석 결과 + 재시도 안내 (에러 태스크만 표시)
    data_source:
      resource: error_analysis
    events:
      - on: key:r
        do: 에러 태스크 재시도 (S-04 트리거)

connections:
  navigations:
    - from: error_section
      to: S-04 에러 재시도

  shared_components: []

tests:
  - name: 일반 태스크 상세
    when: 완료된 태스크 선택
    then:
      - 태스크 헤더 (ID + 이름 + ✔)
      - 메타데이터 (에이전트, 시작/완료 시간)
      - 실행 로그 목록

  - name: 에러 태스크 상세
    when: 실패한 태스크 선택
    then:
      - 태스크 헤더 빨간색 (ID + 이름 + ✘)
      - 에러 메시지 표시
      - AI 분석 결과 표시
      - "[r] 재시도" 안내 표시

  - name: 빈 상태
    when: 태스크 미선택
    then:
      - "태스크를 선택하세요 (j/k로 이동, Enter로 선택)" 표시
