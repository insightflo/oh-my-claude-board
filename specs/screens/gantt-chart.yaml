version: "2.0"

screen:
  name: 간트차트 패널
  route: S-02
  layout: list-collapsible
  auth: false

data_requirements:
  - resource: tasks
    needs: [phases, phase_id, phase_name, phase_status, phase_progress, task_id, task_name, task_status, task_agent, task_blocked_by]

components:
  - id: phase_row
    type: list
    position: main
    function: 접이식 Phase 행 (▼/▶ 토글, 이름, 프로그레스바, 상태 심볼)
    data_source:
      resource: tasks
    events:
      - on: key:space
        do: Phase 접기/펼치기 토글
      - on: key:enter
        do: Phase 요약 정보를 상세 패널에 표시

  - id: task_row
    type: list
    position: main
    function: Task 행 (트리 커넥터, 이름, 프로그레스바, 상태 심볼, 에이전트명)
    data_source:
      resource: tasks
    events:
      - on: key:enter
        do: 선택된 Task 상세를 S-03에 표시
      - on: key:j
        do: 다음 행으로 커서 이동
      - on: key:k
        do: 이전 행으로 커서 이동

  - id: cursor_highlight
    type: detail
    position: main
    function: 현재 선택된 행에 Cyan 배경 하이라이트
    events:
      - on: cursor:move
        do: 하이라이트 위치 업데이트

connections:
  navigations:
    - from: task_row
      to: S-03 태스크 상세
    - from: phase_row
      to: S-03 태스크 상세

  shared_components: []

tests:
  - name: Phase/Task 트리 표시
    when: TASKS.md 파싱 완료
    then:
      - Phase가 접이식 행으로 표시
      - 하위 Task가 트리 커넥터(├/└)와 함께 표시
      - 각 행에 프로그레스바와 상태 심볼 표시

  - name: Phase 접기/펼치기
    when: Phase 행에서 Space 키 입력
    then:
      - 하위 Task 행이 숨겨짐/표시됨
      - ▼ ↔ ▶ 심볼 토글

  - name: 태스크 선택
    when: Task 행에서 Enter 키 입력
    then:
      - S-03 상세 패널에 해당 Task 정보 표시

  - name: 실시간 업데이트
    when: TASKS.md 파일 변경 감지
    then:
      - 변경된 Task 상태 반영
      - Phase 진행률 재계산
      - 현재 커서 위치 유지
