# Data Model Design (ë°ì´í„° ëª¨ë¸ ì„¤ê³„)

> oh-my-claude-boardëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—†ì´ íŒŒì¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ëŠ” TUI ì•±ì…ë‹ˆë‹¤.
> ì´ ë¬¸ì„œëŠ” ì „í†µì  DB ERD ëŒ€ì‹ , ì¸ë©”ëª¨ë¦¬ ìƒíƒœ ëª¨ë¸ê³¼ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

---

## MVP ìº¡ìŠ

| # | í•­ëª© | ë‚´ìš© |
|---|------|------|
| 1 | ëª©í‘œ | Claude Code ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì§„í–‰ ìƒí™©ì„ í„°ë¯¸ë„ì—ì„œ ì‹¤ì‹œê°„ ì‹œê°í™” |
| 2 | í˜ë¥´ì†Œë‚˜ | Claude Code í—¤ë¹„ ìœ ì € |
| 3 | í•µì‹¬ ê¸°ëŠ¥ | FEAT-1: Watch ëª¨ë“œ, FEAT-2: ê°„íŠ¸ì°¨íŠ¸, FEAT-3: ì—ëŸ¬ AI ë¶„ì„ |
| 4 | ì„±ê³µ ì§€í‘œ (ë…¸ìŠ¤ìŠ¤íƒ€) | GitHub Stars 100+ |
| 5 | ì…ë ¥ ì§€í‘œ | ì£¼ê°„ ë‹¤ìš´ë¡œë“œ ìˆ˜ |
| 6 | ë¹„ê¸°ëŠ¥ ìš”êµ¬ | ë Œë”ë§ 60fps, íŒŒì¼ ë³€ê²½ ê°ì§€ < 500ms |
| 7 | Out-of-scope | Wrapper ëª¨ë“œ, ë¹„ìš© íŠ¸ë˜ì»¤, Slack ì—°ë™, ì˜êµ¬ ì €ì¥ì†Œ |
| 8 | Top ë¦¬ìŠ¤í¬ | Rust ê°œë°œ ì†ë„ |
| 9 | ì™„í™”/ì‹¤í—˜ | íŒŒì„œ í”„ë¡œí† íƒ€ì… ë¨¼ì € êµ¬í˜„ |
| 10 | ë‹¤ìŒ ë‹¨ê³„ | TASKS.md íŒŒì„œ êµ¬í˜„ |

---

## 1. ë°ì´í„° ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    External Data Sources                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     TASKS.md (File)    â”‚     Hook Events (JSON Files)    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Phase/Task êµ¬ì¡°  â”‚  â”‚  â”‚ agent_start/end events  â”‚    â”‚
â”‚  â”‚ ìƒíƒœ (âœ…/ğŸ”„/âŒ)  â”‚  â”‚  â”‚ tool_start/end events   â”‚    â”‚
â”‚  â”‚ ì˜ì¡´ì„± ê´€ê³„     â”‚  â”‚  â”‚ error events            â”‚    â”‚
â”‚  â”‚ ì—ì´ì „íŠ¸ í• ë‹¹    â”‚  â”‚  â”‚ timestamps              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                          â”‚
             â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   In-Memory State Model                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  DashboardState                                       â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ phases: Vec<Phase>                               â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ id, name, status, progress                   â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€ tasks: Vec<Task>                             â”‚  â”‚
â”‚  â”‚  â”‚       â”œâ”€â”€ id, name, status, agent                  â”‚  â”‚
â”‚  â”‚  â”‚       â”œâ”€â”€ started_at, completed_at                 â”‚  â”‚
â”‚  â”‚  â”‚       â”œâ”€â”€ logs: Vec<LogEntry>                      â”‚  â”‚
â”‚  â”‚  â”‚       â”œâ”€â”€ error: Option<ErrorInfo>                 â”‚  â”‚
â”‚  â”‚  â”‚       â””â”€â”€ blocked_by: Vec<TaskId>                  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ selected_task: Option<TaskId>                    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ errors: Vec<ErrorEvent>                          â”‚  â”‚
â”‚  â”‚  â””â”€â”€ metadata: SessionMetadata                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ì—”í‹°í‹° ì •ì˜ (In-Memory)

### 2.1 DashboardState (ë£¨íŠ¸)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| phases | Vec\<Phase\> | ì „ì²´ Phase ëª©ë¡ |
| selected_task | Option\<TaskId\> | í˜„ì¬ ì„ íƒëœ íƒœìŠ¤í¬ |
| errors | Vec\<ErrorEvent\> | ì—ëŸ¬ ì´ë²¤íŠ¸ íˆìŠ¤í† ë¦¬ |
| metadata | SessionMetadata | ì„¸ì…˜ ë©”íƒ€ë°ì´í„° |
| last_updated | Instant | ë§ˆì§€ë§‰ ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹œê°„ |

### 2.2 Phase

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | String | Phase ì‹ë³„ì (ì˜ˆ: "phase-1") |
| name | String | Phase ì´ë¦„ (ì˜ˆ: "ê¸°ë°˜ ì„¤ì •") |
| status | PhaseStatus | Pending / InProgress / Completed / Failed |
| progress | f32 | ì™„ë£Œìœ¨ 0.0 ~ 1.0 |
| tasks | Vec\<Task\> | ì†Œì† íƒœìŠ¤í¬ ëª©ë¡ |
| collapsed | bool | UIì—ì„œ ì ‘í˜ ìƒíƒœ |

**PhaseStatus ì „ì´:**
```
Pending â”€â”€â–¶ InProgress â”€â”€â–¶ Completed
                â”‚
                â””â”€â”€â–¶ Failed (í•˜ìœ„ íƒœìŠ¤í¬ ì‹¤íŒ¨ ì‹œ)
```

### 2.3 Task

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | String | íƒœìŠ¤í¬ ì‹ë³„ì (ì˜ˆ: "T1.1") |
| name | String | íƒœìŠ¤í¬ ì´ë¦„ |
| status | TaskStatus | Pending / InProgress / Completed / Failed / Blocked |
| agent | Option\<String\> | í• ë‹¹ëœ ì—ì´ì „íŠ¸ ì´ë¦„ |
| started_at | Option\<DateTime\> | ì‹œì‘ ì‹œê°„ |
| completed_at | Option\<DateTime\> | ì™„ë£Œ ì‹œê°„ |
| duration | Option\<Duration\> | ì†Œìš” ì‹œê°„ (ê³„ì‚°) |
| logs | Vec\<LogEntry\> | ì‹¤í–‰ ë¡œê·¸ |
| error | Option\<ErrorInfo\> | ì—ëŸ¬ ì •ë³´ |
| blocked_by | Vec\<String\> | ì˜ì¡´í•˜ëŠ” íƒœìŠ¤í¬ ID ëª©ë¡ |

**TaskStatus ì „ì´:**
```
Pending â”€â”€â–¶ Blocked (ì˜ì¡´ì„± ë¯¸ì™„ë£Œ)
   â”‚            â”‚
   â”‚            â–¼
   â””â”€â”€â–¶ InProgress â”€â”€â–¶ Completed
              â”‚
              â””â”€â”€â–¶ Failed â”€â”€â–¶ InProgress (ì¬ì‹œë„)
```

### 2.4 ErrorInfo

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| message | String | ì—ëŸ¬ ë©”ì‹œì§€ ì›ë³¸ |
| category | ErrorCategory | Type / Runtime / Network / Permission / Unknown |
| analysis | String | ê·œì¹™ ê¸°ë°˜/AI ë¶„ì„ ê²°ê³¼ |
| retryable | bool | ì¬ì‹œë„ ê°€ëŠ¥ ì—¬ë¶€ |
| occurred_at | DateTime | ì—ëŸ¬ ë°œìƒ ì‹œê°„ |
| source | ErrorSource | TasksMd / HookEvent |

### 2.5 LogEntry

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| timestamp | DateTime | ë¡œê·¸ ì‹œê°„ |
| level | LogLevel | Info / Warn / Error |
| message | String | ë¡œê·¸ ë©”ì‹œì§€ |
| source | String | ì¶œì²˜ (ì—ì´ì „íŠ¸ëª… ë˜ëŠ” ì‹œìŠ¤í…œ) |

### 2.6 SessionMetadata

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| tasks_md_path | PathBuf | TASKS.md íŒŒì¼ ê²½ë¡œ |
| hooks_dir | Option\<PathBuf\> | Hook ì´ë²¤íŠ¸ ë””ë ‰í† ë¦¬ |
| started_at | DateTime | ì„¸ì…˜ ì‹œì‘ ì‹œê°„ |
| total_tasks | usize | ì „ì²´ íƒœìŠ¤í¬ ìˆ˜ |
| completed_tasks | usize | ì™„ë£Œëœ íƒœìŠ¤í¬ ìˆ˜ |
| failed_tasks | usize | ì‹¤íŒ¨í•œ íƒœìŠ¤í¬ ìˆ˜ |

---

## 3. ê´€ê³„ ì •ì˜

```mermaid
erDiagram
    DASHBOARD_STATE ||--o{ PHASE : contains
    DASHBOARD_STATE ||--o{ ERROR_EVENT : tracks
    PHASE ||--o{ TASK : contains
    TASK ||--o| ERROR_INFO : "may have"
    TASK ||--o{ LOG_ENTRY : records
    TASK }o--o{ TASK : "blocked_by"
```

| ë¶€ëª¨ | ìì‹ | ê´€ê³„ | ì„¤ëª… |
|------|------|------|------|
| DashboardState | Phase | 1:N | ëŒ€ì‹œë³´ë“œëŠ” ì—¬ëŸ¬ Phase í¬í•¨ |
| Phase | Task | 1:N | PhaseëŠ” ì—¬ëŸ¬ Task í¬í•¨ |
| Task | ErrorInfo | 1:0..1 | TaskëŠ” ì—ëŸ¬ ì •ë³´ 0~1ê°œ |
| Task | LogEntry | 1:N | TaskëŠ” ì—¬ëŸ¬ ë¡œê·¸ ê¸°ë¡ |
| Task | Task | N:N | Task ê°„ ì˜ì¡´ì„± (blocked_by) |

---

## 4. ë°ì´í„° ì†ŒìŠ¤ íŒŒì‹± ìŠ¤í‚¤ë§ˆ

### 4.1 TASKS.md íŒŒì‹± ê·œì¹™

```markdown
# TASKS.md ì˜ˆì‹œ êµ¬ì¡°

## Phase 1: ê¸°ë°˜ ì„¤ì •
### T1.1 í”„ë¡œì íŠ¸ ì´ˆê¸°í™” [completed] @backend-specialist
### T1.2 DB ìŠ¤í‚¤ë§ˆ ì„¤ê³„ [completed] @database-specialist
  - blocked_by: T1.1

## Phase 2: í•µì‹¬ ê¸°ëŠ¥
### T2.1 API ì—”ë“œí¬ì¸íŠ¸ [in_progress] @backend-specialist
### T2.2 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸ [pending]
  - blocked_by: T2.1
### T2.3 í†µí•© í…ŒìŠ¤íŠ¸ [pending]
  - blocked_by: T2.1, T2.2
```

**íŒŒì‹± ë§¤í•‘:**

| ë§ˆí¬ë‹¤ìš´ ìš”ì†Œ | ìƒíƒœ ëª¨ë¸ í•„ë“œ | íŒŒì‹± ê·œì¹™ |
|-------------|-------------|----------|
| `## Phase N:` | Phase.id, Phase.name | H2 í—¤ë”©ì—ì„œ ì¶”ì¶œ |
| `### TN.M` | Task.id, Task.name | H3 í—¤ë”©ì—ì„œ ì¶”ì¶œ |
| `[completed]` | Task.status = Completed | ëŒ€ê´„í˜¸ ë‚´ ìƒíƒœ ë¬¸ìì—´ |
| `[in_progress]` | Task.status = InProgress | ëŒ€ê´„í˜¸ ë‚´ ìƒíƒœ ë¬¸ìì—´ |
| `[pending]` | Task.status = Pending | ëŒ€ê´„í˜¸ ë‚´ ìƒíƒœ ë¬¸ìì—´ |
| `[failed]` | Task.status = Failed | ëŒ€ê´„í˜¸ ë‚´ ìƒíƒœ ë¬¸ìì—´ |
| `@agent-name` | Task.agent | @ ì ‘ë‘ì‚¬ ì—ì´ì „íŠ¸ëª… |
| `blocked_by: T1.1` | Task.blocked_by | ì˜ì¡´ì„± ëª©ë¡ |

### 4.2 Hook ì´ë²¤íŠ¸ JSON ìŠ¤í‚¤ë§ˆ

```json
{
  "type": "agent_start",
  "timestamp": "2026-02-08T14:23:05.123Z",
  "data": {
    "agent_id": "backend-specialist",
    "task_id": "T2.1",
    "session_id": "abc123"
  }
}
```

| ì´ë²¤íŠ¸ íƒ€ì… | ìƒíƒœ ëª¨ë¸ ë°˜ì˜ |
|------------|-------------|
| agent_start | Task.agent ì„¤ì •, Task.started_at ê¸°ë¡ |
| agent_end | Task.completed_at ê¸°ë¡ |
| tool_start | LogEntry ì¶”ê°€ |
| tool_end | LogEntry ì¶”ê°€ |
| error | ErrorInfo ìƒì„±, Task.status = Failed |

---

## 5. ë°ì´í„° ìƒëª…ì£¼ê¸°

| ë°ì´í„° | ìƒì„± ì‹œì  | ì†Œë©¸ ì‹œì  | ì˜êµ¬ ì €ì¥ |
|--------|----------|----------|----------|
| DashboardState | ì•± ì‹œì‘ | ì•± ì¢…ë£Œ | âŒ ì¸ë©”ëª¨ë¦¬ |
| Phase/Task | TASKS.md ì²« íŒŒì‹± | ì•± ì¢…ë£Œ | âŒ ì¸ë©”ëª¨ë¦¬ |
| LogEntry | Hook ì´ë²¤íŠ¸ ìˆ˜ì‹  | ì•± ì¢…ë£Œ | âŒ ì¸ë©”ëª¨ë¦¬ |
| ErrorInfo | ì—ëŸ¬ ê°ì§€ | ì•± ì¢…ë£Œ | âŒ ì¸ë©”ëª¨ë¦¬ |

> oh-my-claude-boardëŠ” ìƒíƒœë¥¼ ì˜êµ¬ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë“  ë°ì´í„°ëŠ” TASKS.mdì™€ Hook ì´ë²¤íŠ¸ íŒŒì¼ì—ì„œ ì¬êµ¬ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## 6. í™•ì¥ ê³ ë ¤ì‚¬í•­

### 6.1 v2ì—ì„œ ì¶”ê°€ ì˜ˆì •

| ë°ì´í„° | ìš©ë„ | ì €ì¥ ë°©ì‹ |
|--------|------|----------|
| CostEntry | í† í° ì‚¬ìš©ëŸ‰/ë¹„ìš© ì¶”ì  | ì¸ë©”ëª¨ë¦¬ (API ì‘ë‹µ ê¸°ë°˜) |
| NotificationLog | Slack ì•Œë¦¼ ì´ë ¥ | ì¸ë©”ëª¨ë¦¬ |
| SessionHistory | ì´ì „ ì„¸ì…˜ í†µê³„ | JSON íŒŒì¼ (ì„ íƒì ) |

### 6.2 ë°ì´í„° ì¼ê´€ì„± ê·œì¹™

| ê·œì¹™ | ì„¤ëª… |
|------|------|
| TASKS.md ìš°ì„  | ìƒíƒœ ì¶©ëŒ ì‹œ TASKS.mdê°€ ì›ë³¸ |
| ì´ë²¤íŠ¸ ìˆœì„œ | timestamp ê¸°ë°˜ ì •ë ¬ |
| ì¤‘ë³µ ì´ë²¤íŠ¸ | event_id ê¸°ë°˜ ì¤‘ë³µ ì œê±° |
| íŒŒì‹± ì‹¤íŒ¨ | ë§ˆì§€ë§‰ ìœ íš¨ ìƒíƒœ ìœ ì§€ |

---

## Decision Log

| # | ê²°ì • | ê·¼ê±° |
|---|------|------|
| D1 | DB ì—†ì´ ì¸ë©”ëª¨ë¦¬ | TUI ì•±ì´ë¯€ë¡œ ì˜êµ¬ ì €ì¥ ë¶ˆí•„ìš”, ëª¨ë“  ì›ë³¸ì€ íŒŒì¼ |
| D2 | TASKS.md ìƒíƒœ ìš°ì„  | ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ê°€ ì§ì ‘ ê´€ë¦¬í•˜ëŠ” ì›ë³¸ ë°ì´í„° |
| D3 | íŒŒì‹± ì‹¤íŒ¨ ì‹œ í´ë°± | íŒŒì¼ ë³€ê²½ ì¤‘ê°„ ìƒíƒœ ì½ê¸° ë°©ì§€ |
