# PRD (제품 요구사항 정의서)

> Claude Code 오케스트레이션 실행 과정을 실시간으로 시각화하는 TUI 대시보드

---

## MVP 캡슐

| # | 항목 | 내용 |
|---|------|------|
| 1 | 목표 | Claude Code 오케스트레이션 진행 상황을 터미널에서 실시간 시각화 |
| 2 | 페르소나 | Claude Code 헤비 유저 (오케스트레이션/에이전트 스킬 활용 개발자) |
| 3 | 핵심 기능 | FEAT-1: Watch 모드 모니터링, FEAT-2: 간트차트 진행률, FEAT-3: 에러 AI 분석 + 재시도 |
| 4 | 성공 지표 (노스스타) | GitHub Stars 100+ |
| 5 | 입력 지표 | 주간 활성 사용자 수, 이슈/PR 참여 수 |
| 6 | 비기능 요구 | 터미널 렌더링 60fps, 파일 변경 감지 < 500ms |
| 7 | Out-of-scope | Wrapper 모드, 비용 트래커, Slack 연동, 모바일 알림 |
| 8 | Top 리스크 | Rust 개발 속도가 Python 대비 느림 |
| 9 | 완화/실험 | Ratatui 위젯 프로토타입을 먼저 구현하여 난이도 검증 |
| 10 | 다음 단계 | Ratatui 기반 간트차트 위젯 프로토타입 구현 |

---

## 1. 문제 정의

### 1.1 현재 상황 (As-Is)

Claude Code로 대규모 오케스트레이션을 실행하면, 진행 상황이 텍스트 로그로만 흘러간다. 마치 눈을 감고 마라톤을 뛰는 것처럼 — 지금 몇 km인지, 얼마나 남았는지, 어떤 주자(에이전트)가 뛰고 있는지 알 수 없다. TASKS.md를 직접 열어봐야 하고, 에러가 발생해도 텍스트 로그를 스크롤해서 찾아야 한다.

### 1.2 목표 상황 (To-Be)

터미널 화면 왼쪽에 대시보드가 열리고, 오른쪽에서 Claude Code가 실행된다. 대시보드에는 Phase/Task가 간트차트로 펼쳐지고, 현재 어떤 에이전트가 무엇을 하는지 실시간으로 보인다. 에러가 발생하면 빨간색으로 하이라이트되고, AI가 분석 결과를 보여주며, 재시도 버튼 하나로 복구할 수 있다.

### 1.3 왜 지금인가? (Why Now)

- Claude Code의 오케스트레이션 기능이 성숙해지면서 대규모 프로젝트 활용이 증가
- TASKS.md 기반 에이전트 시스템이 표준화되고 있음
- Claude Code Hook 이벤트 시스템이 추가되어 실시간 데이터 수집이 가능해짐
- 경쟁 도구들이 세션 관리에 집중하는 동안, 오케스트레이션 모니터링 공백 존재

---

## 1.5 벤치마킹 분석

### 유사 서비스 분석

| # | 서비스명 | 핵심 기능 | 성공/실패 요인 | 우리와의 차이점 |
|---|----------|----------|---------------|---------------|
| 1 | Ralph TUI | AI 에이전트 세션 관리, TUI 기반 | 단일 세션 관리에 집중, 오케스트레이션 미지원 | 우리는 TASKS.md 기반 다중 Phase/Task 진행률 추적 |
| 2 | Conduit | Claude Code 통합 인터페이스, TUI | 세션 라우팅에 특화, 진행률 시각화 없음 | 우리는 간트차트로 전체 진행률 시각화 |
| 3 | Warp 2.0 | AI 터미널, 에이전트 모드 | 범용 터미널이라 특정 워크플로우 최적화 부족 | 우리는 Claude Code 오케스트레이션 전용 |
| 4 | GitHub Agent HQ | 다중 에이전트 관리 웹 UI | 웹 기반이라 터미널 워크플로우와 단절 | 우리는 터미널 네이티브, Claude Code와 동일 환경 |
| 5 | TmuxCC | tmux + Claude Code 연동 | 화면 분할은 되지만 진행률 시각화 없음 | 우리는 진행률 + 에이전트 상태 + 에러 분석 통합 |

### 차별화 포인트

| 항목 | 경쟁사 | 우리 | 왜 더 나은가? |
|------|--------|------|-------------|
| 진행률 시각화 | 없음 (텍스트 상태만 표시) | Phase/Task 간트차트 실시간 표시 | 전체 작업 중 어디까지 왔는지 한눈에 파악 |
| 에러 대응 | 로그에서 직접 찾아야 함 | 에러 감지 + AI 분석 + 원클릭 재시도 | 에러 발견~복구까지 시간 90% 단축 |
| 데이터 소스 | 독자 포맷 또는 API 의존 | TASKS.md + Claude Code Hook 기반 | 기존 오케스트레이션 워크플로우 변경 없이 사용 |

### 킬러 질문 대응
> "대형 AI 기업이 내일 똑같은 걸 만들면?"

이 도구는 TASKS.md 기반 오케스트레이션이라는 매우 구체적인 워크플로우에 특화되어 있다. 범용 AI 터미널(Warp, Cursor 등)이 이 수준의 특화 기능을 만들 가능성은 낮다. 설령 만들더라도 오픈소스 커뮤니티 기반의 빠른 반복으로 앞서갈 수 있다.

---

## 2. 사용자 페르소나

### 2.1 주요 페르소나

| 항목 | 내용 |
|------|------|
| 이름/별칭 | "오케스트레이터 현우" |
| 나이/직업 | 30대 시니어 개발자 |
| 핵심 니즈 | 대규모 Claude Code 오케스트레이션 실행 시 진행 상황을 한눈에 파악 |
| 불편 포인트 | 텍스트 로그만으로는 전체 진행률 파악 불가, 에러 발생 시 원인 추적에 시간 소요 |
| 사용 상황 | 터미널에서 Claude Code로 대규모 프로젝트 빌드/리팩토링 실행 시 |

### 2.2 페르소나의 하루 (시나리오)

현우는 아침에 출근하여 100개 태스크가 담긴 TASKS.md를 기반으로 오케스트레이션을 시작한다. `oh-my-claude-board watch`를 실행하면 터미널 좌측에 대시보드가 열리고, 우측에서 Claude Code가 태스크를 실행한다. Phase 1의 6개 태스크가 초록색으로 완료되는 것을 확인하고, Phase 2가 시작되면 간트차트에서 현재 진행 중인 태스크가 하이라이트된다. 점심 후 돌아와 보니 Task 2.3에서 빨간색 에러가 떠 있다. 클릭하면 하단 패널에 AI 분석 결과가 나오고 — "타입 불일치: String vs &str" — 재시도 버튼을 눌러 복구한다. 퇴근 전 전체 진행률 67%를 확인하고 만족하며 자리를 뜬다.

---

## 3. 사용자 스토리

### FEAT-0: 공통 (설치/설정)
- [ ] 사용자로서, `cargo install`로 바이너리를 설치할 수 있어야 한다. 왜냐하면 Rust 바이너리는 종속성 없이 배포 가능하기 때문.
- [ ] 사용자로서, 설정 파일 없이 기본값으로 바로 사용할 수 있어야 한다. 왜냐하면 Zero-config가 진입 장벽을 낮추기 때문.

### FEAT-1: Watch 모드 모니터링 (MVP)
- [ ] 사용자로서, TASKS.md 파일 변경을 실시간으로 감지할 수 있어야 한다. 왜냐하면 오케스트레이션 진행 상황의 원천 데이터이기 때문.
- [ ] 사용자로서, Claude Code Hook 이벤트 파일을 감시할 수 있어야 한다. 왜냐하면 에이전트 시작/종료/에러 이벤트를 실시간으로 수집해야 하기 때문.
- [ ] 사용자로서, 화면 좌측에 대시보드, 우측에 Claude Code 출력을 분할 표시할 수 있어야 한다. 왜냐하면 대시보드와 실행 화면을 동시에 봐야 하기 때문.

### FEAT-2: 간트차트 진행률 표시 (MVP)
- [ ] 사용자로서, Phase/Task를 접이식(collapsible) 간트차트로 볼 수 있어야 한다. 왜냐하면 전체 진행률과 세부 태스크를 동시에 파악해야 하기 때문.
- [ ] 사용자로서, 현재 진행 중인 태스크가 하이라이트되어야 한다. 왜냐하면 지금 무엇이 실행 중인지 즉시 알아야 하기 때문.
- [ ] 사용자로서, 태스크를 선택하면 하단 고정 패널에 상세 정보(에이전트명, 시작 시간, 상태, 로그)가 표시되어야 한다. 왜냐하면 특정 태스크의 상세 상태를 확인해야 하기 때문.

### FEAT-3: 에러 감지 + AI 분석 + 재시도 (MVP)
- [ ] 사용자로서, 에러가 발생한 태스크가 빨간색으로 표시되어야 한다. 왜냐하면 문제를 즉시 인지해야 하기 때문.
- [ ] 사용자로서, 에러에 대한 규칙 기반 AI 분석 결과를 볼 수 있어야 한다. 왜냐하면 에러 원인을 빠르게 파악해야 하기 때문.
- [ ] 사용자로서, 실패한 태스크를 재시도할 수 있어야 한다. 왜냐하면 일시적 에러를 빠르게 복구해야 하기 때문.

### FEAT-4: Wrapper 모드 (v2)
- [ ] 사용자로서, 대시보드에서 Claude Code 프로세스를 직접 시작/관리할 수 있어야 한다.

### FEAT-5: 비용 트래커 (v2)
- [ ] 사용자로서, 토큰 사용량과 비용을 실시간으로 모니터링할 수 있어야 한다.

### FEAT-6: Slack 연동 (v2)
- [ ] 사용자로서, Phase 완료/에러 발생 시 Slack 알림을 받을 수 있어야 한다.

---

## 4. 성공 지표

### 4.1 노스스타 지표 (결과 지표)
| 지표명 | 정의 | 목표치 | 측정 주기 |
|--------|------|--------|----------|
| GitHub Stars | 리포지토리 스타 수 | 100+ (6개월 내) | 월간 |

### 4.2 입력 지표 (행동 지표)
| 지표명 | 정의 | 목표치 |
|--------|------|--------|
| 주간 활성 사용자 | crates.io 다운로드 기반 | 50+/주 |
| 이슈/PR 참여 | GitHub 이슈 + PR 수 | 10+/월 |

---

## 5. 범위 관리

### 5.1 MVP (반드시 포함)
- FEAT-1: Watch 모드 (TASKS.md + Hook 파일 모니터링)
- FEAT-2: 접이식 Phase/Task 간트차트 + 태스크 상세 패널
- FEAT-3: 에러 감지 + 규칙 기반 AI 분석 + 재시도
- FEAT-0: cargo install 배포

### 5.2 옵션 (시간 허용 시)
- Anthropic API 연동 AI 에러 분석 (규칙 기반의 확장)
- 설정 파일 (TOML) 지원

### 5.3 Non-goals (명시적 제외)
- Wrapper 모드 (Claude Code 프로세스 관리) — MVP에서 복잡도 과다
- 비용 트래커 — 별도 데이터 소스 필요
- Slack/Discord 연동 — 외부 의존성 증가
- 웹 기반 UI — 터미널 네이티브에 집중

---

## 6. 가정과 리스크

### 6.1 가설 vs 사실

| # | 항목 | 분류 | 내용 | 검증 방법 | 검증 상태 |
|---|------|------|------|----------|----------|
| 1 | TASKS.md 포맷 | 🟢 사실 | 오케스트레이션 스킬이 TASKS.md를 생성/수정함 | 직접 사용 경험 | ✅ 검증됨 |
| 2 | Hook 이벤트 파일 | 🟢 사실 | Claude Code Hook이 JSON 이벤트를 파일로 출력 | Claude Code 문서 확인 | ✅ 검증됨 |
| 3 | 시장 수요 | 🔴 가설 | Claude Code 헤비 유저가 진행률 시각화를 원함 | GitHub 이슈/스타로 검증 | ❌ 미검증 |
| 4 | Ratatui 간트차트 | 🔴 가설 | Ratatui로 접이식 간트차트 구현이 실용적임 | 프로토타입 구현으로 검증 | ❌ 미검증 |
| 5 | 단독 사용 가치 | 🔴 가설 | Watch 모드만으로도 충분한 가치 제공 | MVP 출시 후 피드백 | ❌ 미검증 |

### 6.2 핵심 가정
| # | 가정 | 검증 방법 |
|---|------|----------|
| 1 | TASKS.md 파싱이 안정적으로 가능하다 | nom/pest 파서 프로토타입 |
| 2 | 파일 감시가 모든 OS에서 안정적이다 | notify crate 크로스플랫폼 테스트 |
| 3 | 터미널 분할이 자연스럽게 작동한다 | cokacdir-main 참조 구현 |

### 6.3 Top 5 리스크 보드

| # | 가정 | 리스크 | 완화 | 트리거 | 대응 |
|---|------|--------|------|--------|------|
| 1 | Rust 개발 속도 | MVP 완성까지 예상보다 오래 걸림 | Ratatui 예제 코드 적극 활용 | 2주 내 간트차트 프로토타입 미완성 | Python Textual로 피벗 |
| 2 | TASKS.md 포맷 변동 | 오케스트레이션 스킬 업데이트로 포맷 변경 | 파서를 유연하게 설계 (허용적 파싱) | 파싱 실패율 > 5% | 포맷 버전 감지 + 어댑터 패턴 |
| 3 | 터미널 호환성 | 특정 터미널에서 렌더링 깨짐 | 주요 터미널 3종(iTerm2, Alacritty, Terminal.app) 테스트 | 사용자 이슈 리포트 | 터미널별 렌더링 모드 분기 |
| 4 | Hook 이벤트 누락 | Claude Code Hook이 모든 이벤트를 전달하지 않음 | TASKS.md와 Hook 데이터 교차 검증 | 상태 불일치 감지 | TASKS.md를 primary source로 폴백 |
| 5 | 시장 무관심 | 출시 후 사용자가 없음 | 커뮤니티 사전 홍보 (Reddit, Twitter) | 출시 1개월 후 스타 < 10 | 개인 도구로 활용, 대규모 AI 프로젝트 모니터링 도구로 방향 전환 |

---

## 7. 해결 가설과 실험

### 7.1 가설
> 만약 Claude Code 오케스트레이션 실행 시 터미널 분할 대시보드로 진행률/에이전트/에러를 실시간 표시하면, 개발자의 작업 상태 파악 시간이 90% 단축될 것이다. 왜냐하면 현재 텍스트 로그 스크롤 → 시각적 한눈 파악으로 전환되기 때문.

### 7.2 실험 루프

| 단계 | 내용 |
|------|------|
| 실험 | Ratatui 간트차트 프로토타입 + TASKS.md 파서 구현 |
| 관측 | 프로토타입 완성까지 소요 시간, 렌더링 품질 |
| 학습 | Rust/Ratatui가 이 프로젝트에 적합한 기술 스택인가? |
| 다음 | 적합하면 MVP 풀 구현, 부적합하면 Python Textual로 피벗 |

---

## 8. 타협 기록

### 8.1 핵심 가치 (절대 타협 불가)
| # | 핵심 가치 | 왜 중요한가? | 현재 점수 (1-10) |
|---|----------|-------------|-----------------|
| 1 | 터미널 네이티브 | Claude Code와 동일한 환경에서 동작해야 자연스러움 | 10 |
| 2 | 실시간 시각화 | 진행률을 "실시간으로" 보는 것이 존재 이유 | 10 |
| 3 | 제로 설정 | 설치 후 바로 사용 가능해야 진입 장벽이 낮음 | 9 |

### 8.2 타협 내역
| # | 원래 계획 | 현재 계획 | 타협 이유 | 복구 계획 |
|---|----------|----------|----------|----------|
| 1 | Wrapper + Watch 모드 동시 지원 | Watch 모드만 MVP | MVP 복잡도 관리 | v2에서 Wrapper 모드 추가 |
| 2 | Anthropic API 기반 AI 분석 | 규칙 기반 패턴 매칭 + API 선택 | API 키 의존성 제거 | 선택적 API 연동으로 확장 |
| 3 | 비용 트래커 포함 | v2로 연기 | 별도 데이터 소스 필요, MVP 범위 초과 | v2에서 토큰 사용량 추적 추가 |

---

## 9. 실패 대응 계획

### 9.1 MVP 정의

| 항목 | 내용 |
|------|------|
| MVP 기능 | Watch 모드 + 간트차트 + 태스크 상세 + 에러 AI 분석 |
| 검증 목표 | "실시간 진행률 시각화가 오케스트레이션 작업에 가치 있는가?" |
| 성공 기준 | 출시 3개월 내 GitHub Stars 30+, 이슈 5+ |
| 실패 기준 | 출시 3개월 내 GitHub Stars < 5, 다운로드 < 10 |

### 9.2 실패 시나리오
| 시나리오 | 확률 | 영향 | 대응 방안 |
|----------|------|------|----------|
| Rust 개발 난이도로 MVP 지연 | 중 | 높 | Python Textual로 빠르게 피벗 |
| 사용자 무관심 (스타 < 5) | 중 | 중 | 개인 도구로 활용 + 대규모 AI 프로젝트 모니터링 방향 전환 |
| TASKS.md 포맷 호환성 문제 | 낮 | 중 | 유연한 파서 설계로 사전 대비 |

### 9.3 학습 목표

| 성공 시 배울 것 | 실패 시 배울 것 |
|---------------|---------------|
| Ratatui로 복잡한 TUI 위젯 구현 역량 | Rust vs Python TUI 개발 생산성 비교 데이터 |
| TASKS.md 파싱 패턴 표준화 | 오케스트레이션 모니터링의 실제 수요 수준 |
| 오픈소스 프로젝트 런칭 경험 | 마케팅/커뮤니티 빌딩 인사이트 |

### 9.4 피벗 옵션

| 옵션 | 트리거 | 방향 전환 내용 |
|------|--------|--------------|
| Plan B | 2주 내 Ratatui 프로토타입 미완성 | Python Textual로 기술 스택 전환 |
| Plan C | MVP 출시 후 3개월 내 스타 < 5 | 범용 AI 에이전트 모니터링 도구로 확장 (Claude Code 전용 → 범용) |

---

## Decision Log

| # | 결정 | 근거 | 대안 |
|---|------|------|------|
| D1 | Watch 모드 전용 MVP | 복잡도 관리, Wrapper는 v2 | 둘 다 지원 (거부됨: MVP 범위 초과) |
| D2 | Ratatui (Rust) 선택 | 성능, 바이너리 배포, 품질감 | Textual (Python) — 피벗 옵션으로 유지 |
| D3 | 규칙 기반 AI 분석 | API 키 의존성 제거 | Anthropic API 전용 (거부됨: 진입 장벽) |
| D4 | 오픈소스 배포 | 커뮤니티 기반 성장, 스타 100+ 목표 | 유료 (거부됨: 초기 사용자 확보 우선) |
| D5 | cokacdir-main 스타일 화면 분할 | 검증된 터미널 분할 패턴 | 독자 분할 로직 (불필요한 재발명) |
